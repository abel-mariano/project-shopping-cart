(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))n(t);new MutationObserver(t=>{for(const c of t)if(c.type==="childList")for(const s of c.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function o(t){const c={};return t.integrity&&(c.integrity=t.integrity),t.referrerPolicy&&(c.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?c.credentials="include":t.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function n(t){if(t.ep)return;t.ep=!0;const c=o(t);fetch(t.href,c)}})();const _=()=>{const e=localStorage.getItem("cartProducts");return e?JSON.parse(e):[]},P=e=>{if(!e)throw new Error("Você deve fornecer um ID");const o=[..._(),e];localStorage.setItem("cartProducts",JSON.stringify(o))},L=e=>{if(!e)throw new Error("Você deve fornecer um ID");const r=[..._()],o=r.indexOf(e);r.splice(o,1),localStorage.setItem("cartProducts",JSON.stringify(r))},g=async e=>{const r="https://api.mercadolibre.com/items/";if(!e)throw new Error("ID não informado");return await(await fetch(`${r}${e}`)).json()},v=async e=>{const r="https://api.mercadolibre.com/sites/MLB/search?q=";if(!e)throw new Error("Termo de busca não informado");return(await(await fetch(`${r}${e}`)).json()).results},h=()=>{const e=document.querySelectorAll(".cart__product"),r=document.querySelector(".total-price");let o=0;o===0&&(e.forEach(n=>{const t=n.querySelector(".product__price__value").innerHTML;o+=Number(t)}),r.innerHTML=o.toFixed(2))},m=e=>{const r=document.createElement("img");return r.className="product__image",r.src=e.replace("I.jpg","O.jpg"),r},a=(e,r,o="")=>{const n=document.createElement(e);return n.className=r,n.innerText=o,n},E=(e,r)=>{e.remove(),L(r),h()},y=({id:e,title:r,price:o,pictures:n})=>{const t=document.createElement("li");t.className="cart__product";const c=a("div","cart__product__image-container"),s=m(n[0].url);c.appendChild(s);const i=m((n[1]||n[0]).url);c.appendChild(i),t.appendChild(c);const d=a("div","cart__product__info-container");d.appendChild(a("span","product__title",r));const u=a("span","product__price","R$ ");u.appendChild(a("span","product__price__value",o)),d.appendChild(u),t.appendChild(d);const p=a("i","material-icons cart__product__remove","delete");return t.appendChild(p),t.addEventListener("click",()=>E(t,e)),t},S=({id:e,title:r,thumbnail:o,price:n})=>{const t=document.createElement("section");t.className="product",t.appendChild(a("span","product__id",e));const c=a("div","img__container");c.appendChild(m(o)),t.appendChild(c),t.appendChild(a("span","product__title",r));const s=a("span","product__price","R$ ");s.appendChild(a("span","product__price__value",n)),t.appendChild(s);const i=a("button","product__add","Adicionar ao carrinho!");return i.addEventListener("click",async()=>{const d=document.querySelector(".cart__products"),u=await g(e);P(e);const p=y(u);d.appendChild(p),h()}),t.appendChild(i),t},w="https://cep.awesomeapi.com.br/json/",b="https://brasilapi.com.br/api/cep/v2/",f=document.querySelector(".cart__address"),I=document.querySelector(".cep-input"),$=async e=>(await Promise.any([fetch(`${w}${e}`),fetch(`${b}${e}`)])).json(),q=async()=>{try{const e=await $(I.value);f.innerHTML=`${e.street||e.address} - ${e.neighborhood||e.district} - ${e.city} - ${e.state}`}catch{f.innerHTML="CEP não encontrado"}};const C=document.querySelector(".products"),l=document.querySelector(".loading"),N=document.querySelector(".cart__products");document.querySelector(".cep-button").addEventListener("click",q);const O=async()=>{l.innerHTML="Carregando...",l.classList.add("error");try{const e=await v("computador");C.innerHTML="",e.forEach(r=>{C.appendChild(S(r))})}catch{l.innerHTML="Algum erro ocorreu, recarregue a página e tente novamente"}};O();const T=_(),M=T.map(e=>g(e));Promise.all(M).then(e=>{e.forEach(r=>N.appendChild(y(r))),h()});
